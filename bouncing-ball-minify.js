var canvas=document.getElementById("myCanvas");var ctx=canvas.getContext("2d");var balls=[];var ballRadius=2;var ballColor="#000000";var maxSpeed=3;var threshold=1E-4;var reboundEnergyPercentage=.75;document.addEventListener("mouseup",mouseUpHandler,false);
function mouseUpHandler(e){var canvas=document.getElementById("myCanvas");ball={x:e.clientX-canvas.offsetLeft,y:e.clientY-canvas.offsetTop,dx:Math.random()*(maxSpeed*2)-maxSpeed,dy:Math.random()*-maxSpeed,t:Date.now()/1E3,bounce:0,stopped:false};balls.push(ball)}
function doUpdate(item,index,arr){if(item.dx==0&&item.dy==0){item.stopped=true;return}if(item.x+item.dx>canvas.width-ballRadius||item.x+item.dx<ballRadius)item.dx*=-1;if(item.y+item.dy<ballRadius)item.dy*=-1;if(item.y+item.dy>canvas.height-ballRadius){item.dy*=-reboundEnergyPercentage;item.dx*=reboundEnergyPercentage;item.bounce+=1}else item.dy+=.0981*(Date.now()/1E3-item.t);item.x+=item.dx;item.y+=item.dy;if(Math.abs(item.dx)<threshold)item.dx=0;if(Math.abs(item.dy)<threshold)item.dy=0}
function doRender(item,index,arr){ctx.beginPath();ctx.arc(item.x,item.y,ballRadius,0,Math.PI*2);ctx.fillStyle=ballColor;ctx.fill();ctx.closePath()}function run(){ctx.clearRect(0,0,canvas.width,canvas.height);balls.forEach(doRender);balls.forEach(doUpdate);requestAnimationFrame(run)}run();